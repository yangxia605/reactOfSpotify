/** * Created by mianmian on 2018/3/15. */const CLIENT_ID = 'b1c5f647ad044b9c9aadf340da3b7e0d';const REDIRECT_URI= 'http%3a%2f%2flocalhost%3a3000%2f';//http://localhost:3000/const accessToken=  '';const Spotify = {  //Get a Spotify user's access token  getAccessToken: function () {    if(Spotify.accessToken){      return Spotify.accessToken;    }else{      //check if it has just been obtained.      const accessTokenMatch = window.location.href.match(/access_token=([^&]*)/);      const expiresInMatch = window.location.href.match(/expires_in=([^&]*)/);      //if login,return the accessToken      if(accessTokenMatch ){//token has just been obtained.        //Set the access token value        Spotify.accessToken=accessTokenMatch;        // expire time        window.setTimeout(() => Spotify.accessToken = '', expiresInMatch * 1000);        window.history.pushState({accessToken: ''}, null, '/');      }else{        //make request        const URL= `https://accounts.spotify.com/authorize?client_id=${CLIENT_ID}&response_type=token&scope=playlist-modify-public&redirect_uri=${REDIRECT_URI}`,        window.location.href=URl;      }    }  },  //Send a search request to the Spotify API  search: function(term){    Spotify.getAccessToken();    return fetch(`https://api.spotify.com/v1/search?type=track&q=${term}`,{     headers: {       Authorization: `Bearer ${accessToken}`     }   }).then(response => {      return response.json();   }).then(jsonResponse => {     if(jsonResponse.tracks){       return jsonResponse.tracks.map((track) => ({       ID: track.id,       Name:track.name,       Artist:track.artists[0].name,       Album:track.album.name,       URI:track.uri     }));     }   })  },  //Save a user's playlist to their Spotify account.  savePlaylist: function (playlistName, trackUris) {    var accessToken =  Spotify.accessToken;    var header = {      'Authorization': 'Bearer ' + accessToken    };    var userId = '';    if(playlistName ==='' || trackUris.length === 0){      return false;    }  }};export default Spotify;